{
  "datasets": [
    {
      "name": "ds_executive_summary",
      "displayName": "Executive Summary",
      "queryLines": [
        "WITH unique_consumption AS (SELECT COALESCE(SUM(actual_cost), 0) as total_unique_consumed FROM main.account_monitoring_dev.dashboard_data), contract_totals AS (SELECT SUM(commitment) as total_contract_value, COUNT(*) as contract_count FROM main.account_monitoring_dev.contract_burndown_summary) SELECT ct.total_contract_value, uc.total_unique_consumed as total_consumed, GREATEST(ct.total_contract_value - uc.total_unique_consumed, 0) as remaining_budget, ct.contract_count FROM contract_totals ct, unique_consumption uc"
      ]
    },
    {
      "name": "ds_pace_distribution",
      "displayName": "Pace Distribution",
      "queryLines": [
        "SELECT contract_id, pace_status, ROUND(consumed_pct, 1) as consumed_pct FROM main.account_monitoring_dev.contract_burndown_summary ORDER BY CASE WHEN pace_status LIKE '%OVER%' THEN 1 WHEN pace_status LIKE '%ABOVE%' THEN 2 WHEN pace_status LIKE '%ON PACE%' THEN 3 ELSE 4 END"
      ]
    },
    {
      "name": "ds_combined_burndown",
      "displayName": "Combined Burndown",
      "queryLines": [
        "WITH daily_data AS (SELECT usage_date, SUM(cumulative_cost) as total_actual, SUM(commitment) as total_commitment FROM main.account_monitoring_dev.contract_burndown WHERE usage_date >= DATE_SUB(CURRENT_DATE(), 365) GROUP BY usage_date), actuals AS (SELECT usage_date as date, total_actual as value, 'Actual Consumption' as series_type FROM daily_data), commitment AS (SELECT usage_date as date, total_commitment as value, 'Contract Commitment' as series_type FROM daily_data) SELECT * FROM actuals UNION ALL SELECT * FROM commitment ORDER BY date, series_type"
      ]
    },
    {
      "name": "ds_contract_burndown",
      "displayName": "Contract Burndown",
      "queryLines": [
        "WITH base_data AS (SELECT contract_id, usage_date, ROUND(cumulative_cost, 2) as actual_consumption, ROUND(commitment, 2) as contract_value FROM main.account_monitoring_dev.contract_burndown WHERE usage_date >= DATE_SUB(CURRENT_DATE(), 180)), actuals AS (SELECT contract_id, usage_date as date, actual_consumption as value, CONCAT(contract_id, ' - Actual') as series_type FROM base_data), commitment AS (SELECT contract_id, usage_date as date, contract_value as value, CONCAT(contract_id, ' - Commitment') as series_type FROM base_data) SELECT * FROM actuals UNION ALL SELECT * FROM commitment ORDER BY contract_id, date, series_type"
      ]
    },
    {
      "name": "ds_contract_summary",
      "displayName": "Contract Summary",
      "queryLines": [
        "SELECT contract_id, cloud_provider, start_date, end_date, ROUND(commitment, 0) as contract_value, ROUND(total_consumed, 2) as consumed, ROUND(budget_remaining, 2) as remaining, ROUND(consumed_pct, 1) as consumed_pct, pace_status, days_remaining, projected_end_date FROM main.account_monitoring_dev.contract_burndown_summary ORDER BY consumed_pct DESC"
      ]
    },
    {
      "name": "ds_monthly_consumption",
      "displayName": "Monthly Consumption by Contract",
      "queryLines": [
        "SELECT DATE_TRUNC('MONTH', usage_date) as month, contract_id, SUM(daily_cost) as monthly_cost FROM main.account_monitoring_dev.contract_burndown WHERE usage_date >= DATE_SUB(CURRENT_DATE(), 365) GROUP BY DATE_TRUNC('MONTH', usage_date), contract_id ORDER BY month, contract_id"
      ]
    },
    {
      "name": "ds_forecast_with_history",
      "displayName": "Forecast with History",
      "queryLines": [
        "WITH history AS (SELECT b.contract_id, b.usage_date as date, b.cumulative_cost as actual_value, CAST(NULL AS DOUBLE) as forecast_value, CAST(NULL AS DOUBLE) as lower_bound, CAST(NULL AS DOUBLE) as upper_bound, b.commitment as contract_commitment FROM main.account_monitoring_dev.contract_burndown b), forecast AS (SELECT f.contract_id, f.forecast_date as date, CAST(NULL AS DOUBLE) as actual_value, f.predicted_cumulative as forecast_value, f.lower_bound + (SELECT MAX(cumulative_cost) FROM main.account_monitoring_dev.contract_burndown WHERE contract_id = f.contract_id) as lower_bound, f.upper_bound + (SELECT MAX(cumulative_cost) FROM main.account_monitoring_dev.contract_burndown WHERE contract_id = f.contract_id) as upper_bound, c.total_value as contract_commitment FROM main.account_monitoring_dev.contract_forecast f JOIN main.account_monitoring_dev.contracts c ON f.contract_id = c.contract_id WHERE f.forecast_date > (SELECT MAX(usage_date) FROM main.account_monitoring_dev.contract_burndown WHERE contract_id = f.contract_id)) SELECT * FROM history UNION ALL SELECT * FROM forecast ORDER BY contract_id, date"
      ]
    },
    {
      "name": "ds_prophet_combined",
      "displayName": "Contract Burndown with ML Forecast",
      "queryLines": [
        "WITH contract_dates AS (SELECT contract_id, MIN(usage_date) as min_date, MAX(usage_date) as max_date, MAX(commitment) as commitment FROM main.account_monitoring_dev.contract_burndown GROUP BY contract_id), all_dates AS (SELECT DISTINCT contract_id, usage_date as date FROM main.account_monitoring_dev.contract_burndown UNION SELECT DISTINCT f.contract_id, f.forecast_date as date FROM main.account_monitoring_dev.contract_forecast f INNER JOIN contract_dates cd ON f.contract_id = cd.contract_id WHERE f.forecast_date > cd.max_date), actuals AS (SELECT b.contract_id, b.usage_date as date, b.cumulative_cost as value, CONCAT(b.contract_id, ' - Historical') as series_type FROM main.account_monitoring_dev.contract_burndown b), forecasts AS (SELECT f.contract_id, f.forecast_date as date, f.predicted_cumulative as value, CONCAT(f.contract_id, ' - Forecast') as series_type FROM main.account_monitoring_dev.contract_forecast f INNER JOIN contract_dates cd ON f.contract_id = cd.contract_id WHERE f.forecast_date > cd.max_date), commitment_line AS (SELECT ad.contract_id, ad.date, cd.commitment as value, CONCAT(ad.contract_id, ' - Commitment') as series_type FROM all_dates ad INNER JOIN contract_dates cd ON ad.contract_id = cd.contract_id) SELECT * FROM actuals UNION ALL SELECT * FROM forecasts UNION ALL SELECT * FROM commitment_line ORDER BY contract_id, date, series_type"
      ]
    },
    {
      "name": "ds_forecast_summary",
      "displayName": "Forecast Summary",
      "queryLines": [
        "SELECT f.contract_id, f.cloud_provider, f.contract_value, f.exhaustion_date_p10, f.exhaustion_date_p50, f.exhaustion_date_p90, f.days_to_exhaustion, f.forecast_status, f.contract_end FROM main.account_monitoring_dev.contract_forecast_details f WHERE f.forecast_date = (SELECT MAX(forecast_date) FROM main.account_monitoring_dev.contract_forecast WHERE contract_id = f.contract_id)"
      ]
    },
    {
      "name": "ds_contracts_at_risk",
      "displayName": "Contracts at Risk",
      "queryLines": [
        "SELECT COUNT(DISTINCT contract_id) as at_risk_count FROM main.account_monitoring_dev.contract_forecast_details WHERE forecast_status = 'AT RISK'"
      ]
    },
    {
      "name": "ds_product_category",
      "displayName": "Cost by Product Category",
      "queryLines": [
        "SELECT DATE_TRUNC('MONTH', usage_date) as month, product_category, ROUND(SUM(actual_cost), 2) as total_cost FROM main.account_monitoring_dev.dashboard_data WHERE usage_date >= DATE_SUB(CURRENT_DATE(), 365) GROUP BY DATE_TRUNC('MONTH', usage_date), product_category ORDER BY month, product_category"
      ]
    },
    {
      "name": "ds_top_workspaces",
      "displayName": "Top Workspaces",
      "queryLines": [
        "SELECT workspace_id, cloud_provider, ROUND(SUM(actual_cost), 2) as total_cost, ROUND(SUM(usage_quantity), 2) as total_dbu, COUNT(DISTINCT sku_name) as unique_skus FROM main.account_monitoring_dev.dashboard_data WHERE usage_date >= DATE_SUB(CURRENT_DATE(), 30) GROUP BY workspace_id, cloud_provider ORDER BY total_cost DESC LIMIT 10"
      ]
    },
    {
      "name": "ds_top_skus",
      "displayName": "Top SKUs",
      "queryLines": [
        "SELECT sku_name, cloud_provider, usage_unit, ROUND(SUM(usage_quantity), 2) as total_usage, ROUND(SUM(actual_cost), 2) as total_cost FROM main.account_monitoring_dev.dashboard_data WHERE usage_date >= DATE_SUB(CURRENT_DATE(), 90) GROUP BY sku_name, cloud_provider, usage_unit ORDER BY total_cost DESC LIMIT 10"
      ]
    },
    {
      "name": "ds_monthly_by_cloud",
      "displayName": "Monthly Cost by Cloud",
      "queryLines": [
        "SELECT DATE_TRUNC('MONTH', usage_date) as month, cloud_provider, ROUND(SUM(actual_cost), 2) as monthly_cost FROM main.account_monitoring_dev.dashboard_data WHERE usage_date >= DATE_SUB(CURRENT_DATE(), 365) GROUP BY DATE_TRUNC('MONTH', usage_date), cloud_provider ORDER BY month"
      ]
    },
    {
      "name": "ds_consumption_trend",
      "displayName": "Daily Consumption with Moving Average",
      "queryLines": [
        "SELECT usage_date, daily_cost, AVG(daily_cost) OVER (ORDER BY usage_date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) as moving_avg_7d, AVG(daily_cost) OVER (ORDER BY usage_date ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) as moving_avg_30d FROM (SELECT usage_date, SUM(daily_cost) as daily_cost FROM main.account_monitoring_dev.contract_burndown GROUP BY usage_date) daily WHERE usage_date >= DATE_SUB(CURRENT_DATE(), 180) ORDER BY usage_date"
      ]
    },
    {
      "name": "ds_exhaustion_date",
      "displayName": "Contract Exhaustion Date",
      "queryLines": [
        "SELECT c.contract_id, c.start_date, c.end_date, c.total_value as commitment, COALESCE(f.exhaustion_date_p50, c.end_date) as predicted_exhaustion_date, CASE WHEN f.exhaustion_date_p50 IS NOT NULL THEN DATEDIFF(f.exhaustion_date_p50, CURRENT_DATE()) ELSE DATEDIFF(c.end_date, CURRENT_DATE()) END as days_until_exhaustion, f.model_version, CASE WHEN f.exhaustion_date_p50 < c.end_date THEN \"EARLY EXHAUSTION\" WHEN f.exhaustion_date_p50 > c.end_date THEN \"UNDER-CONSUMPTION\" ELSE \"ON TRACK\" END as exhaustion_status FROM main.account_monitoring_dev.contracts c LEFT JOIN (SELECT contract_id, exhaustion_date_p50, model_version FROM main.account_monitoring_dev.contract_forecast WHERE forecast_date = (SELECT MAX(forecast_date) FROM main.account_monitoring_dev.contract_forecast)) f ON c.contract_id = f.contract_id WHERE c.status = \"ACTIVE\""
      ]
    },
    {
      "name": "ds_whatif_scenarios",
      "displayName": "What-If Discount Scenarios",
      "queryLines": [
        "WITH extension_scenarios AS (SELECT scenario_id FROM main.account_monitoring_dev.discount_scenarios WHERE status = 'ACTIVE' AND scenario_name LIKE 'Extend to%'), baseline_burndown AS (SELECT sb.contract_id, sb.usage_date as date, sb.simulated_cumulative as value, 'Baseline (No Discount)' as series_type FROM main.account_monitoring_dev.scenario_burndown sb JOIN main.account_monitoring_dev.discount_scenarios ds ON sb.scenario_id = ds.scenario_id WHERE ds.status = 'ACTIVE' AND ds.is_baseline = TRUE), baseline_forecast AS (SELECT sf.contract_id, sf.forecast_date as date, sf.predicted_cumulative + (SELECT MAX(simulated_cumulative) FROM main.account_monitoring_dev.scenario_burndown WHERE scenario_id = sf.scenario_id) as value, 'Baseline (No Discount)' as series_type FROM main.account_monitoring_dev.scenario_forecast sf JOIN main.account_monitoring_dev.discount_scenarios ds ON sf.scenario_id = ds.scenario_id WHERE ds.status = 'ACTIVE' AND ds.is_baseline = TRUE AND sf.forecast_date > (SELECT MAX(usage_date) FROM main.account_monitoring_dev.scenario_burndown WHERE scenario_id = sf.scenario_id)), baseline_stats AS (SELECT contract_id, MAX(date) as last_date, MAX(value) as last_value, AVG(value / DATEDIFF(date, (SELECT MIN(usage_date) FROM main.account_monitoring_dev.scenario_burndown sb2 JOIN main.account_monitoring_dev.discount_scenarios ds2 ON sb2.scenario_id = ds2.scenario_id WHERE ds2.is_baseline = TRUE AND sb2.contract_id = baseline_forecast.contract_id))) as avg_daily_rate FROM baseline_forecast GROUP BY contract_id), baseline_extended AS (SELECT ext.contract_id, ext.usage_date as date, bs.last_value + (DATEDIFF(ext.usage_date, bs.last_date) * (SELECT AVG(sf.predicted_daily_cost) FROM main.account_monitoring_dev.scenario_forecast sf JOIN main.account_monitoring_dev.discount_scenarios ds ON sf.scenario_id = ds.scenario_id WHERE ds.is_baseline = TRUE AND sf.contract_id = ext.contract_id)) as value, 'Baseline (No Discount)' as series_type FROM main.account_monitoring_dev.scenario_burndown ext JOIN main.account_monitoring_dev.discount_scenarios ds ON ext.scenario_id = ds.scenario_id CROSS JOIN baseline_stats bs WHERE ds.status = 'ACTIVE' AND ds.scenario_name LIKE 'Extend to%' AND ext.usage_date > bs.last_date AND ext.contract_id = bs.contract_id), extension_data AS (SELECT sb.contract_id, sb.usage_date as date, sb.simulated_cumulative as value, CONCAT(ds.scenario_name, ' (', CAST(ds.discount_pct AS INT), '% Discount)') as series_type FROM main.account_monitoring_dev.scenario_burndown sb JOIN main.account_monitoring_dev.discount_scenarios ds ON sb.scenario_id = ds.scenario_id WHERE ds.status = 'ACTIVE' AND sb.scenario_id IN (SELECT scenario_id FROM extension_scenarios)), all_dates AS (SELECT contract_id, date FROM baseline_burndown UNION SELECT contract_id, date FROM baseline_forecast UNION SELECT contract_id, date FROM baseline_extended UNION SELECT contract_id, date FROM extension_data), commitment_line AS (SELECT ad.contract_id, ad.date, c.total_value as value, 'Contract Commitment' as series_type FROM all_dates ad JOIN main.account_monitoring_dev.contracts c ON ad.contract_id = c.contract_id) SELECT * FROM baseline_burndown UNION ALL SELECT * FROM baseline_forecast UNION ALL SELECT * FROM baseline_extended UNION ALL SELECT * FROM extension_data UNION ALL SELECT * FROM commitment_line ORDER BY contract_id, date"
      ]
    },
    {
      "name": "ds_whatif_longer_duration",
      "displayName": "Longer Duration Opportunities",
      "queryLines": [
        "SELECT ss.contract_id, ss.scenario_name as opportunity, ss.discount_pct as potential_discount, ROUND(ss.cumulative_savings, 0) as potential_savings, ss.days_extended as potential_days_extended, ds.description FROM main.account_monitoring_dev.scenario_summary ss JOIN main.account_monitoring_dev.discount_scenarios ds ON ss.scenario_id = ds.scenario_id WHERE ds.status = 'ACTIVE' AND ds.description LIKE '%extended to%' ORDER BY ss.contract_id, ss.discount_pct"
      ]
    },
    {
      "name": "ds_whatif_sweet_spot",
      "displayName": "Sweet Spot Recommendations",
      "queryLines": [
        "SELECT contract_id, scenario_name, discount_pct as best_discount, ROUND(cumulative_savings, 0) as savings, days_extended, ROUND(utilization_pct, 1) as utilization_pct FROM main.account_monitoring_dev.scenario_summary WHERE is_sweet_spot = TRUE"
      ]
    },
    {
      "name": "ds_whatif_explanation",
      "displayName": "Strategy Explanation",
      "queryLines": [
        "WITH contract_info AS (SELECT c.contract_id, c.total_value, c.start_date, c.end_date, DATEDIFF(c.end_date, CURRENT_DATE()) as days_remaining FROM main.account_monitoring_dev.contracts c WHERE c.status = 'ACTIVE'), baseline AS (SELECT ss.contract_id, ss.actual_cumulative, ss.exhaustion_status, ss.scenario_exhaustion_date FROM main.account_monitoring_dev.scenario_summary ss JOIN main.account_monitoring_dev.discount_scenarios ds ON ss.scenario_id = ds.scenario_id WHERE ds.is_baseline = TRUE), extension AS (SELECT ss.contract_id, ss.discount_pct, ss.cumulative_savings, ss.contract_end as extended_end_date, ss.days_extended FROM main.account_monitoring_dev.scenario_summary ss JOIN main.account_monitoring_dev.discount_scenarios ds ON ss.scenario_id = ds.scenario_id WHERE ds.scenario_name LIKE 'Extend to%') SELECT 1 as sort_order, CONCAT('üìã CONTRACT: $', FORMAT_NUMBER(ci.total_value, 0), ' commitment') as explanation FROM contract_info ci UNION ALL SELECT 2, CONCAT('üìÖ CURRENT TERM: ', DATE_FORMAT(ci.start_date, 'MMM d, yyyy'), ' ‚Üí ', DATE_FORMAT(ci.end_date, 'MMM d, yyyy'), ' (', ci.days_remaining, ' days remaining)') FROM contract_info ci UNION ALL SELECT 3, CONCAT('üìà CONSUMED: $', FORMAT_NUMBER(b.actual_cumulative, 0), ' of $', FORMAT_NUMBER(ci.total_value, 0), ' (', ROUND(b.actual_cumulative / ci.total_value * 100, 1), '%) ‚Äî $', FORMAT_NUMBER(ci.total_value - b.actual_cumulative, 0), ' remaining') FROM contract_info ci JOIN baseline b ON ci.contract_id = b.contract_id UNION ALL SELECT 4, CONCAT('‚ö†Ô∏è STATUS: ', b.exhaustion_status, COALESCE(CONCAT(' ‚Äî exhaustion predicted ', DATE_FORMAT(b.scenario_exhaustion_date, 'MMM d, yyyy')), ' ‚Äî contract will NOT exhaust before end date')) FROM baseline b UNION ALL SELECT 5, CONCAT('üí° EXTENSION: Extend to 3yr (new end: ', DATE_FORMAT(e.extended_end_date, 'MMM d, yyyy'), ') for ', CAST(e.discount_pct AS INT), '% discount') FROM extension e UNION ALL SELECT 6, CONCAT('üí∞ SAVINGS: $', FORMAT_NUMBER(e.cumulative_savings, 0), ' total savings with extension') FROM extension e ORDER BY sort_order"
      ]
    }
  ],
  "pages": [
    {
      "name": "page_executive",
      "displayName": "Executive Summary",
      "layout": [
        {
          "widget": {
            "name": "w_total_value",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_executive_summary",
                  "fields": [
                    {
                      "name": "total_contract_value",
                      "expression": "`total_contract_value`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_contract_value",
                  "displayName": "Total Contract Value (USD)"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total Contract Value"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "w_total_consumed",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_executive_summary",
                  "fields": [
                    {
                      "name": "total_consumed",
                      "expression": "`total_consumed`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "total_consumed",
                  "displayName": "Total Consumed (USD)"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total Consumed"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "w_remaining",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_executive_summary",
                  "fields": [
                    {
                      "name": "remaining_budget",
                      "expression": "`remaining_budget`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "remaining_budget",
                  "displayName": "Remaining Budget (USD)"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Remaining Budget"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "w_pace_bar",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_pace_distribution",
                  "fields": [
                    {
                      "name": "contract_id",
                      "expression": "`contract_id`"
                    },
                    {
                      "name": "consumed_pct",
                      "expression": "`consumed_pct`"
                    },
                    {
                      "name": "pace_status",
                      "expression": "`pace_status`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "contract_id",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "Contract"
                },
                "y": {
                  "fieldName": "consumed_pct",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "% Consumed"
                },
                "color": {
                  "fieldName": "pace_status",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "Pace Status"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Contract Pace Distribution"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 3,
            "height": 4
          }
        },
        {
          "widget": {
            "name": "w_combined_burndown",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_combined_burndown",
                  "fields": [
                    {
                      "name": "date",
                      "expression": "`date`"
                    },
                    {
                      "name": "value",
                      "expression": "`value`"
                    },
                    {
                      "name": "series_type",
                      "expression": "`series_type`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "date",
                  "scale": {
                    "type": "temporal"
                  },
                  "displayName": "Date"
                },
                "y": {
                  "fieldName": "value",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Total (USD)"
                },
                "color": {
                  "fieldName": "series_type",
                  "scale": {
                    "type": "categorical",
                    "mappings": [
                      {
                        "value": "Actual Consumption",
                        "color": "#FFD700"
                      },
                      {
                        "value": "Contract Commitment",
                        "color": "#00008B"
                      }
                    ]
                  },
                  "displayName": "Series"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Combined Contract Consumption - All Contracts"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 2,
            "width": 3,
            "height": 4
          }
        },
        {
          "widget": {
            "name": "w_daily_trend",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_consumption_trend",
                  "fields": [
                    {
                      "name": "usage_date",
                      "expression": "`usage_date`"
                    },
                    {
                      "name": "daily_cost",
                      "expression": "`daily_cost`"
                    },
                    {
                      "name": "moving_avg_7d",
                      "expression": "`moving_avg_7d`"
                    },
                    {
                      "name": "moving_avg_30d",
                      "expression": "`moving_avg_30d`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "usage_date",
                  "scale": {
                    "type": "temporal"
                  },
                  "displayName": "Date"
                },
                "y": {
                  "fieldName": "daily_cost",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Daily Cost (USD)"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Daily Consumption with Moving Averages (7d & 30d)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 6,
            "width": 6,
            "height": 4
          }
        },
        {
          "widget": {
            "name": "w_contract_summary_exec",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_contract_summary",
                  "fields": [
                    {
                      "name": "contract_id",
                      "expression": "`contract_id`"
                    },
                    {
                      "name": "cloud_provider",
                      "expression": "`cloud_provider`"
                    },
                    {
                      "name": "contract_value",
                      "expression": "`contract_value`"
                    },
                    {
                      "name": "consumed",
                      "expression": "`consumed`"
                    },
                    {
                      "name": "consumed_pct",
                      "expression": "`consumed_pct`"
                    },
                    {
                      "name": "pace_status",
                      "expression": "`pace_status`"
                    },
                    {
                      "name": "days_remaining",
                      "expression": "`days_remaining`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "contract_id",
                    "displayName": "Contract",
                    "type": "string"
                  },
                  {
                    "fieldName": "cloud_provider",
                    "displayName": "Cloud",
                    "type": "string"
                  },
                  {
                    "fieldName": "contract_value",
                    "displayName": "Commitment ($)",
                    "type": "number",
                    "numberFormat": "#,##0"
                  },
                  {
                    "fieldName": "consumed",
                    "displayName": "Consumed ($)",
                    "type": "number",
                    "numberFormat": "#,##0"
                  },
                  {
                    "fieldName": "consumed_pct",
                    "displayName": "% Used",
                    "type": "number",
                    "numberFormat": "0.0%"
                  },
                  {
                    "fieldName": "pace_status",
                    "displayName": "Pace Status",
                    "type": "string"
                  },
                  {
                    "fieldName": "days_remaining",
                    "displayName": "Days Left",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Contract Details & Status"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 10,
            "width": 6,
            "height": 4
          }
        }
      ],
      "pageType": "PAGE_TYPE_CANVAS"
    },
    {
      "name": "page_burndown",
      "displayName": "Contract Burndown",
      "layout": [
        {
          "widget": {
            "name": "w_burndown_chart",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_contract_burndown",
                  "fields": [
                    {
                      "name": "date",
                      "expression": "`date`"
                    },
                    {
                      "name": "value",
                      "expression": "`value`"
                    },
                    {
                      "name": "series_type",
                      "expression": "`series_type`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "date",
                  "scale": {
                    "type": "temporal"
                  },
                  "displayName": "Date"
                },
                "y": {
                  "fieldName": "value",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Cumulative Cost (USD)"
                },
                "color": {
                  "fieldName": "series_type",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "Series"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Contract Burndown - Actual vs Commitment"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "w_prophet_burndown",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_prophet_combined",
                  "fields": [
                    {
                      "name": "series_type",
                      "expression": "`series_type`"
                    },
                    {
                      "name": "date",
                      "expression": "`date`"
                    },
                    {
                      "name": "value",
                      "expression": "`value`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "frame": {
                "showTitle": true,
                "title": "Contract Burndown with Prophet ML Forecast"
              },
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "date",
                  "displayName": "Date",
                  "scale": {
                    "type": "temporal"
                  }
                },
                "y": {
                  "fieldName": "value",
                  "displayName": "Cumulative Cost ($)",
                  "scale": {
                    "type": "quantitative"
                  }
                },
                "color": {
                  "fieldName": "series_type",
                  "displayName": "Series",
                  "scale": {
                    "type": "categorical"
                  }
                }
              }
            }
          },
          "position": {
            "x": 0,
            "y": 5,
            "width": 6,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "w_contract_table",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_contract_summary",
                  "fields": [
                    {
                      "name": "contract_id",
                      "expression": "`contract_id`"
                    },
                    {
                      "name": "cloud_provider",
                      "expression": "`cloud_provider`"
                    },
                    {
                      "name": "start_date",
                      "expression": "`start_date`"
                    },
                    {
                      "name": "end_date",
                      "expression": "`end_date`"
                    },
                    {
                      "name": "contract_value",
                      "expression": "`contract_value`"
                    },
                    {
                      "name": "consumed",
                      "expression": "`consumed`"
                    },
                    {
                      "name": "remaining",
                      "expression": "`remaining`"
                    },
                    {
                      "name": "consumed_pct",
                      "expression": "`consumed_pct`"
                    },
                    {
                      "name": "pace_status",
                      "expression": "`pace_status`"
                    },
                    {
                      "name": "days_remaining",
                      "expression": "`days_remaining`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "contract_id",
                    "displayName": "Contract ID",
                    "type": "string"
                  },
                  {
                    "fieldName": "cloud_provider",
                    "displayName": "Cloud",
                    "type": "string"
                  },
                  {
                    "fieldName": "start_date",
                    "displayName": "Start Date",
                    "type": "datetime",
                    "dateTimeFormat": "YYYY-MM-DD"
                  },
                  {
                    "fieldName": "end_date",
                    "displayName": "End Date",
                    "type": "datetime",
                    "dateTimeFormat": "YYYY-MM-DD"
                  },
                  {
                    "fieldName": "contract_value",
                    "displayName": "Commitment ($)",
                    "type": "number",
                    "numberFormat": "#,##0"
                  },
                  {
                    "fieldName": "consumed",
                    "displayName": "Consumed ($)",
                    "type": "number",
                    "numberFormat": "#,##0.00"
                  },
                  {
                    "fieldName": "remaining",
                    "displayName": "Remaining ($)",
                    "type": "number",
                    "numberFormat": "#,##0.00"
                  },
                  {
                    "fieldName": "consumed_pct",
                    "displayName": "% Used",
                    "type": "number",
                    "numberFormat": "0.0%"
                  },
                  {
                    "fieldName": "pace_status",
                    "displayName": "Pace Status",
                    "type": "string"
                  },
                  {
                    "fieldName": "days_remaining",
                    "displayName": "Days Left",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Contract Details & Status"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 10,
            "width": 6,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "w_exhaustion_date",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_exhaustion_date",
                  "fields": [
                    {
                      "name": "contract_id",
                      "expression": "`contract_id`"
                    },
                    {
                      "name": "commitment",
                      "expression": "`commitment`"
                    },
                    {
                      "name": "predicted_exhaustion_date",
                      "expression": "`predicted_exhaustion_date`"
                    },
                    {
                      "name": "days_until_exhaustion",
                      "expression": "`days_until_exhaustion`"
                    },
                    {
                      "name": "model_version",
                      "expression": "`model_version`"
                    },
                    {
                      "name": "exhaustion_status",
                      "expression": "`exhaustion_status`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "contract_id",
                    "displayName": "Contract",
                    "type": "string"
                  },
                  {
                    "fieldName": "commitment",
                    "displayName": "Commitment ($)",
                    "type": "number",
                    "numberFormat": "#,##0"
                  },
                  {
                    "fieldName": "predicted_exhaustion_date",
                    "displayName": "Predicted Exhaustion Date",
                    "type": "datetime",
                    "dateTimeFormat": "YYYY-MM-DD"
                  },
                  {
                    "fieldName": "days_until_exhaustion",
                    "displayName": "Days Until Exhaustion",
                    "type": "number"
                  },
                  {
                    "fieldName": "model_version",
                    "displayName": "Forecast Model",
                    "type": "string"
                  },
                  {
                    "fieldName": "exhaustion_status",
                    "displayName": "Status",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Contract Exhaustion Prediction"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 15,
            "width": 6,
            "height": 3
          }
        }
      ],
      "pageType": "PAGE_TYPE_CANVAS"
    },
    {
      "name": "page_whatif",
      "displayName": "What-If Analysis",
      "layout": [
        {
          "widget": {
            "name": "w_whatif_chart",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_whatif_scenarios",
                  "fields": [
                    {
                      "name": "date",
                      "expression": "`date`"
                    },
                    {
                      "name": "value",
                      "expression": "`value`"
                    },
                    {
                      "name": "series_type",
                      "expression": "`series_type`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "date",
                  "scale": {
                    "type": "temporal"
                  },
                  "displayName": "Date"
                },
                "y": {
                  "fieldName": "value",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Cumulative Cost ($)"
                },
                "color": {
                  "fieldName": "series_type",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "Scenario"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "What-If Discount Scenario Comparison"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 4,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "w_sweet_spot",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_whatif_sweet_spot",
                  "fields": [
                    {
                      "name": "contract_id",
                      "expression": "`contract_id`"
                    },
                    {
                      "name": "scenario_name",
                      "expression": "`scenario_name`"
                    },
                    {
                      "name": "best_discount",
                      "expression": "`best_discount`"
                    },
                    {
                      "name": "savings",
                      "expression": "`savings`"
                    },
                    {
                      "name": "days_extended",
                      "expression": "`days_extended`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "contract_id",
                    "displayName": "Contract",
                    "type": "string"
                  },
                  {
                    "fieldName": "scenario_name",
                    "displayName": "Best Scenario",
                    "type": "string"
                  },
                  {
                    "fieldName": "best_discount",
                    "displayName": "Discount %",
                    "type": "number",
                    "numberFormat": "0"
                  },
                  {
                    "fieldName": "savings",
                    "displayName": "Savings ($)",
                    "type": "number",
                    "numberFormat": "#,##0"
                  },
                  {
                    "fieldName": "days_extended",
                    "displayName": "Days Extended",
                    "type": "number"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Recommended Scenario (Sweet Spot)"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 0,
            "width": 2,
            "height": 3
          }
        },
        {
          "widget": {
            "name": "w_longer_duration",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_whatif_longer_duration",
                  "fields": [
                    {
                      "name": "contract_id",
                      "expression": "`contract_id`"
                    },
                    {
                      "name": "opportunity",
                      "expression": "`opportunity`"
                    },
                    {
                      "name": "potential_discount",
                      "expression": "`potential_discount`"
                    },
                    {
                      "name": "potential_savings",
                      "expression": "`potential_savings`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "contract_id",
                    "displayName": "Contract",
                    "type": "string"
                  },
                  {
                    "fieldName": "opportunity",
                    "displayName": "If Extended To",
                    "type": "string"
                  },
                  {
                    "fieldName": "potential_discount",
                    "displayName": "Potential %",
                    "type": "number",
                    "numberFormat": "0"
                  },
                  {
                    "fieldName": "potential_savings",
                    "displayName": "Potential Savings ($)",
                    "type": "number",
                    "numberFormat": "#,##0"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Incentive to Extend Duration"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 3,
            "width": 2,
            "height": 3
          }
        },
        {
          "widget": {
            "name": "w_strategy_explanation",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_whatif_explanation",
                  "fields": [
                    {
                      "name": "explanation",
                      "expression": "`explanation`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "explanation",
                    "displayName": " ",
                    "type": "string"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Strategy & Savings Explained"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 6,
            "width": 6,
            "height": 4
          }
        }
      ],
      "pageType": "PAGE_TYPE_CANVAS"
    }
  ],
  "uiSettings": {
    "theme": {
      "widgetHeaderAlignment": "ALIGNMENT_UNSPECIFIED"
    },
    "applyModeEnabled": false
  }
}

